{"version":3,"sources":["webpack:///./src/components/maps/japan.js","webpack:///./src/pages/japan.jsx"],"names":["JapanMap","_Component","props","_this","call","getLoc","state","loc","drawChart","div","d3","select","remove","height","node","offsetHeight","width","offsetWidth","console","log","svg","append","attr","projection","scale","center","translate","path","selected","title_loc","visited","then","data","features","topojson","objects","japan","selectAll","enter","style","e","properties","nam","includes","on","setLoc","newLoc","newLocJa","nam_ja","setState","loc_ja","this","title_loc_ja","setTitleLoc","_inheritsLoose","_proto","prototype","componentDidMount","window","addEventListener","bind","render","React","createElement","Fragment","id","className","Component","Japan","_ref","useState","openPhoto","setOpenPhoto","modalHidden","setModalHidden","photos","allPhotos","allFile","edges","i","length","name","place","split","push","image","getImage","childImageSharp","Layout","tab","SEO","title","Title","Link","href","Text","description","Flex","boxWidth","toLowerCase","map","photo","index","Box","key","onClick","GatsbyImage","alt","cursor","PhotoModal","text","hidden","newModalHidden","info","japanPhotoInformation","date","location"],"mappings":"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","file":"component---src-pages-japan-jsx-e360ba977374bd36a186.js","sourcesContent":["import React, { Component } from \"react\"\nimport * as d3 from \"d3\"\nimport * as topojson from \"topojson-client\";\nimport \"./japan.css\"\n\n\nclass JapanMap extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      title_loc: \"Japan\",\n      title_loc_ja: \"日本\",\n      loc: \"Japan\",\n      loc_ja: \"日本\",\n    };\n  }\n\n  getLoc = () => {\n    return this.state.loc\n  }\n\n  componentDidMount() {\n    this.drawChart();\n    window.addEventListener(\"resize\", this.drawChart.bind(this));\n  }\n\n  drawChart = () => {\n    const div = d3.select(\"#japan\");\n    div.select('svg').remove();\n\n    const height = +div.node().offsetHeight;\n    const width = +div.node().offsetWidth;\n    console.log(\"height: \", height)\n    console.log(\"width: \", width)\n\n    const svg = div.append('svg')\n      .attr(\"width\", width)\n      .attr(\"height\", height);\n\n    var projection = d3.geoMercator()\n      .scale(1200)\n      .center([137,37])\n      .translate([width/2,250])\n\n    var path = d3.geoPath().projection(projection);\n\n    var selected = this.state.title_loc\n\n    const visited = [\"Tokyo To\", \"Kyoto Fu\", \"Osaka Fu\", \"Fukuoka Ken\", \"Nara Ken\", \"Aichi Ken\"]\n    const selectedColor = \"#FFD148\";\n    const visitedColor = \"#f5d1c6\"\n    const nonVisitedColor = \"white\"\n\n    const setLoc = (newLoc, newLocJa) => {\n      this.setState({loc: newLoc, loc_ja: newLocJa})\n    }\n\n    const setTitleLoc = (newLoc, newLocJa) => {\n      this.setState({title_loc: newLoc})\n      this.setState({title_loc_ja: newLocJa})\n      this.props.setLoc(newLoc)\n      selected = this.state.title_loc\n    }\n\n    const resetLoc = () => {\n      this.setState({loc: this.state.title_loc, loc_ja: this.state.title_loc_ja})\n    }\n\n\n    d3.json(\"/json/topojapan.json\").then(data => {\n      var features = topojson.feature(data, data.objects.japan).features\n\n      svg.selectAll(\"path\")\n        .data(features)\n        .enter()\n        .append(\"path\")\n        .attr(\"d\", path)\n        .attr(\"stroke\", \"black\")\n        .style(\"stroke-width\", \"0.6\")\n        .style(\"fill\", function(e) {\n          if (selected === e.properties.nam) {\n            return selectedColor\n          } else if (visited.includes(e.properties.nam)) {\n            return visitedColor\n          } else {\n            return nonVisitedColor\n          }\n        })\n        .on(\"mouseover\", function(e) {\n          setLoc(e.properties.nam, e.properties.nam_ja)\n          if (visited.includes(e.properties.nam)) {\n            d3.select(this).style(\"fill\", \"#d9bbb2\")\n          } else {\n            d3.select(this).style(\"fill\", \"lightgrey\")\n          }\n        })\n        .on(\"mouseout\", function(e) {\n          if (e.properties.nam === selected) {\n            d3.select(this).style(\"fill\", selectedColor)\n          } else if (visited.includes(e.properties.nam)) {\n            d3.select(this).style(\"fill\", visitedColor)\n          } else {\n            d3.select(this).style(\"fill\", nonVisitedColor)\n          }\n          resetLoc()\n        })\n        .on(\"click\", function(e) {\n          if (visited.includes(e.properties.nam)) {\n            svg.selectAll(\"path\")\n              .style(\"fill\", function(e) {\n                if (visited.includes(e.properties.nam)) {\n                  return visitedColor\n                } else {\n                  return nonVisitedColor\n                }\n              })\n            setTitleLoc(e.properties.nam, e.properties.nam_ja)\n            d3.select(this).style(\"fill\", selectedColor)\n          }\n        })\n    });\n\n  };\n\n  render() {\n    return (\n      <>\n        <div id=\"japan-labels\">\n          <p id=\"english-label\">{this.state.loc}</p>\n          <p id=\"japanese-label\">{this.state.loc_ja}</p>\n        </div>\n        <div id=\"japan\" className=\"mapDiv\"></div>\n      </>\n    )\n  }\n}\n\nexport default JapanMap\n","import React, { useState } from \"react\"\nimport { graphql } from \"gatsby\"\nimport { GatsbyImage, getImage } from \"gatsby-plugin-image\"\n\nimport Layout from \"../components/layouts/layout\"\nimport SEO from \"../components/seo\"\nimport JapanMap from \"../components/maps/japan\"\nimport PhotoModal from \"../components/photoModal\"\n\nimport { japanPhotoInformation } from \"../images/japan/info\"\n\nimport { Box, Flex, Link, Text, Title } from \"../components/basics\"\n\nexport default function Japan({ data }) {\n  const [loc, setLoc] = useState(\"Japan\")\n  const [openPhoto, setOpenPhoto] = useState({})\n  const [modalHidden, setModalHidden] = useState(true)\n\n  var photos = {}\n  var allPhotos = data.allFile.edges\n\n  for (var i = 0; i < allPhotos.length; i++) {\n    var name = allPhotos[i].node.name\n    var place = name.split(\"_\")[0]\n    if (place in photos) {\n      photos[place].push({\n        name: name,\n        image: getImage(allPhotos[i].node.childImageSharp),\n      })\n    } else {\n      photos[place] = [\n        { name: name, image: getImage(allPhotos[i].node.childImageSharp) },\n      ]\n    }\n  }\n\n  return (\n    <Layout tab=\"Japan\">\n      <SEO title=\"Japan\" />\n      <Title>\n        <Link href=\"/writing/visualizing-japan\">Japan</Link>\n      </Title>\n      <Text description>August 2019</Text>\n\n      <JapanMap setLoc={newLoc => setLoc(newLoc)} />\n\n      <Flex boxWidth=\"49.5%\" photos>\n        {loc !== \"Japan\" &&\n          photos[loc.split(\" \")[0].toLowerCase()].map((photo, index) => {\n            return (\n              <Box\n                key={photo.name}\n                photo\n                onClick={e => {\n                  setOpenPhoto(photo)\n                  setModalHidden(false)\n                }}\n              >\n                <GatsbyImage\n                  alt={photo.name}\n                  key={photo.name}\n                  image={photo.image}\n                  style={{ cursor: \"pointer\" }}\n                />\n              </Box>\n            )\n          })}\n      </Flex>\n\n      <PhotoModal\n        text=\"modal text\"\n        hidden={modalHidden}\n        photo={openPhoto}\n        setModalHidden={newModalHidden => setModalHidden(newModalHidden)}\n        info={\n          japanPhotoInformation[openPhoto.name] || {\n            date: \"\",\n            location: \"\",\n            description: [\"\"],\n          }\n        }\n      />\n    </Layout>\n  )\n}\n\nexport const pageQuery = graphql`\n  query JapanPhotos {\n    allFile(filter: {extension: {regex: \"/(jpg)|(jpeg)|(png)/\"}, dir: {regex: \"/images/japan/\"}}) {\n      edges {\n        node {\n          id\n          name\n          childImageSharp {\n            gatsbyImageData(\n              placeholder: BLURRED\n              formats: [AUTO, WEBP, AVIF]\n            )\n          }\n        }\n      }\n    }\n  }\n`\n"],"sourceRoot":""}